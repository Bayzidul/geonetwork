<?xml version="1.0" encoding="UTF-8"?>

<!--
==============================================================================
=== Build file to allow ant (http://jakarta.apache.org/ant/) to be used
=== to build the Geonetwork project.
===
=== Author : Andrea Carboni <acarboni@users.sourceforge.net>
==============================================================================
-->

<project name="geonetwork" default="compile">

	<!-- =============================================================== -->

	<target name="compile">
		<delete	file="web/WEB-INF/lib/geonetwork.jar" />
		<delete	file="web/WEB-INF/lib/setup.jar" />
		<delete	file="migrate/lib/migration.jar" />
		<delete	file="csw/lib/csw-client.jar" />
		<delete	file="csw/lib/csw-common.jar" />
		<delete	file="gast/gast.jar" />
		<delete	dir =".build" />
		<mkdir	dir =".build" />

		<javac	srcdir  ="src"
					destdir =".build"
					extdirs ="web/WEB-INF/lib"
					includes="org/**"
					debug   ="true" />

		<copy			todir = ".build">
			<fileset dir   = "src" includes = "*.properties"/>
		</copy>
		
		<jar		jarfile ="web/WEB-INF/lib/geonetwork.jar"
					basedir =".build"
					includes="**" />
		
		<jar		jarfile ="web/WEB-INF/lib/setup.jar"
					basedir =".build"
					includes="org/fao/geonet/apps/setup/Boot.class,org/fao/geonet/apps/common/**">
			<manifest>
				<attribute name="Main-Class" value="org.fao.geonet.apps.setup.Boot"/>
			</manifest>
		</jar>
		
		<jar		jarfile ="migrate/lib/migration.jar"
					basedir =".build"
					includes="org/fao/geonet/apps/migration/Boot.class,org/fao/geonet/apps/common/**">
			<manifest>
				<attribute name="Main-Class" value="org.fao.geonet.apps.migration.Boot"/>
			</manifest>
		</jar>
		
		<jar		jarfile ="csw/lib/csw-client.jar"
					basedir =".build"
					includes="org/fao/geonet/csw/client/**" />
		
		<jar		jarfile ="csw/lib/csw-common.jar"
					basedir =".build"
					includes="org/fao/geonet/csw/common/**" />
		
		<jar		jarfile ="gast/gast.jar"
					basedir =".build"
					includes="org/fao/gast/Gast.class, org/fao/gast/boot/**">
			<manifest>
				<attribute name="Main-Class" value="org.fao.gast.Gast"/>
			</manifest>
		</jar>
		
		<delete dir=".build"/>
	</target>

	<!-- =============================================================== -->

    <target name="javadoc">
        <delete   dir="docs/javadoc" />
        <mkdir    dir="docs/javadoc" />
        <javadoc	sourcepath  ="src" 
						destdir     ="docs/javadoc" 
						packagenames="org.fao.*"
						windowtitle ="Geonetwork class documentation"/>
    </target>

	<!-- =============================================================== -->

    <target name="all" depends="compile,javadoc"/>
	
	<!-- =============================================================== -->

</project>
