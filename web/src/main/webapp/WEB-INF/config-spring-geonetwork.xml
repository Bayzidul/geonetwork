<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<import resource="config-security.xml"/>
	
	<util:set id="languages">
		<value>ara</value>
		<value>cat</value>
		<value>chi</value>
		<value>dut</value>
		<value>eng</value>
		<value>fin</value>
		<value>fre</value>
		<value>ger</value>
		<value>ita</value>
		<value>nor</value>
		<value>pol</value>
		<value>por</value>
		<value>rus</value>
		<value>spa</value>
		<value>tur</value>
	</util:set>
	<bean id="RegionsDAO" class="org.fao.geonet.services.region.ThesaurusBasedRegionsDAO">
		<constructor-arg ref="languages"></constructor-arg>
		<property name="cacheAllRegionsInMemory" value="true"/>
		<property name="thesaurusName" value="external.place.regions"/>
	</bean>
	<bean id="MetadataRegionsDAO" class="org.fao.geonet.services.region.MetadataRegionDAO">
		<property name="cacheAllRegionsInMemory" value="false"/>
	</bean>

    <bean name="metadataCacheSeeder" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
        <property name="jobClass" value="org.fao.geonet.services.metadata.MetadataCacheSeeder" />
        <property name="jobDataAsMap">
          <map>
            <entry key="xslStylesheet" value="pigma-static-html" />
            <entry key="cachePath" value="/tmp/pigma-md-cache" />
          </map>
        </property>
    </bean>

	<bean id="metadataCacheSeederCronTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
		<property name="jobDetail" ref="metadataCacheSeeder" />
        <!-- runs every minutes -->
        <property name="cronExpression" value="0 * * * * ?" />
        <property name="startDelay" value="30000"/>
	</bean>
	
	<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <property name="jobFactory">
            <bean class="org.fao.geonet.util.spring.AutowiringSpringBeanJobFactory"/>
        </property>
        <property name="triggers">
            <list>
                <ref bean="metadataCacheSeederCronTrigger" />
            </list>
        </property>
    </bean>

</beans>
