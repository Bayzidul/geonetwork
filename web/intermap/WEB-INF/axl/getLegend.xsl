<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">		<xsl:template match="/">		<ARCXML>			<REQUEST>				<GET_IMAGE>					<PROPERTIES>						<xsl:apply-templates select="/service/envelope/ENVELOPE" />						<DRAW map="false" />						<LEGEND title="legend" autoextend="true"><!--							[[xsl:call-template name="layers" /]]-->						</LEGEND>					</PROPERTIES>				</GET_IMAGE>			</REQUEST>		</ARCXML>	</xsl:template>		<!-- ENVELOPE Element -->	<xsl:template match="ENVELOPE">		<ENVELOPE reaspect="true">			<xsl:attribute name="minx"><xsl:value-of select="@minx" /></xsl:attribute>			<xsl:attribute name="maxx"><xsl:value-of select="@maxx" /></xsl:attribute>			<xsl:attribute name="miny"><xsl:value-of select="@miny" /></xsl:attribute>			<xsl:attribute name="maxy"><xsl:value-of select="@maxy" /></xsl:attribute>		</ENVELOPE>	</xsl:template>		<xsl:template name="layers">		<LAYERS>			<xsl:for-each select="/service/visibleLayers/layer">				<LAYER>					<xsl:variable name="id" select="@internalId" />					<xsl:attribute name="id"><xsl:value-of select="/service/info/ARCXML/RESPONSE/SERVICEINFO/LAYERINFO[@internalId=$id]/@id" /></xsl:attribute>				</LAYER>			</xsl:for-each>		</LAYERS>	</xsl:template>	</xsl:stylesheet>