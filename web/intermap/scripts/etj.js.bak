
var minLayersDivWidth = 236;


function im_init(mmr)
{
            setMapSize(400,300);
//	var height = getWindowSize()[1]; // - Element.getHeight('banner');
//	$('im_layers').style.height = height + 'px';
	
	
	window.name = "InterMap";
	window.focus();

	//Event.observe(document, 'mousedown', resizeLayersDivStart);
	//new Draggable('im_resizeBar', {constraint:'horizontal',change:resizeLayersDiv});
	
	Event.observe('im_map', 'mousedown', mousedownEventListener);
	Event.observe('im_mm_map', 'mousedown', im_mm_mousedownEventListener);
	
	setTool('zoomin'); // set the default tool
	im_mm_setTool('zoomin'); // set the default tool
	
	imc_appendLayers(); // append layers to list
	//setLayersDivWidth(minLayersDivWidth);
	
	//Event.observe('geonetRecords', 'mouseover', function(){ $('geonetRecords').className = 'opaque'; });
	//Event.observe('geonetRecords', 'mouseout', function(){ $('geonetRecords').className = ''; });
	
	// keyboard events
	Event.observe(document, 'keypress', function(e) { keyPressed(e) });

	im_mm_setTextControls($('northBL'), $('eastBL'), $('southBL'), $('westBL'))

	im_mm_init(mmr);
}

function im_mm_init(minimapResponse)
{
           var mmurl = minimapResponse.getElementsByTagName('imgUrl')[0].textContent;
	$('im_mm_image').src = mmurl;
	
	var extent=minimapResponse.getElementsByTagName('extent')[0];
	var minx  = extent.getAttribute('minx');
	var maxx = extent.getAttribute('maxx');
	var miny  = extent.getAttribute('miny');
	var maxy = extent.getAttribute('maxy');

	var w = minimapResponse.getElementsByTagName('width')[0].textContent;
	var h = minimapResponse.getElementsByTagName('height')[0].textContent;

         im_mm_setMapProp(maxy, maxx, miny, minx, w, h);

/*	$('northBL').value     =miny;
	$('southBL').value     =maxy;
	$('westBL').value      =minx;	
	$('eastBL').value      =maxx;
*/}

function setMapSize(w, h)
{
	$('im_mapContainer').style.width = w+2; 
	$('im_mapContainer').style.height = h+2; 
	
	$('im_map').style.width = w; //<xsl:value-of select="/root/response/mapRoot/response/imageWidth" /> + 'px';
	$('im_map').style.height = h; //<xsl:value-of select="/root/response/mapRoot/response/imageHeight" /> + 'px';
	
	$('im_pleaseWait').style.width = w; 
/*	$('im_pleaseWait').style.height = h; 	
	$('im_pleaseWait').style.top = h/2;*/	
}


function runIM_addService(url, service, type)
{
    imc_addService(url, service, type, function() {im_refreshLayerList()});    
}


function im_refreshLayerList()

function runIM_selectService(url, type)
{

}

